Sub ExportToPDF(Optional LocalPath As String)
    Dim wb As Workbook
    Dim FileName As String
    Dim FullPath As String

    ' Set the active workbook
    Set wb = ActiveWorkbook

    ' Check if a local path is provided; if not, use workbook's default path
    If LocalPath = "" Then
        LocalPath = wb.Path
    End If

    ' Ensure the workbook is saved
    If LocalPath = "" Then
        MsgBox "De werkmap is nog niet opgeslagen. Sla deze eerst op voordat je het naar PDF exporteert.", vbExclamation
        Exit Sub
    End If

    ' Generate the PDF file name using the workbook name
    FileName = Left(wb.Name, InStrRev(wb.Name, ".") - 1) & ".pdf"
    FullPath = LocalPath & "\" & FileName

    ' Export workbook to PDF
    On Error GoTo ErrorHandler
    wb.ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullPath, Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
    Exit Sub

ErrorHandler:
    ' Error message if export fails
    MsgBox "Er is een fout opgetreden tijdens het exporteren van de werkmap naar een PDF. Controleer of het bestand al geopend is of of er voldoende schrijfrechten zijn.", vbCritical
End Sub

